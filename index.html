<!DOCTYPE html>
<html>
<head>
  <title>Save to Google Sheet</title>
</head>
<body>
  <h2>Contact Form</h2>
  <form id="myForm">
    <input type="text" id="name" placeholder="Enter Name"><br><br>
    <input type="email" id="email" placeholder="Enter Email"><br><br>
    <textarea id="message" placeholder="Enter Message"></textarea><br><br>
    <button type="submit">Submit</button>
  </form>
    <hr/>
      <button onclick="loadData()">Load Data</button>
    <div id="output"></div>
  <script>
   
    const scriptURL = "https://script.google.com/macros/s/AKfycbyuzWHDwK2avfaRp8oP270RyoA7FXbfyg9-s9IS0Lj3oDcV-FKP2pLY2FitcXZgh3yInQ/exec";
    
    async function loadData() {
      let res = await fetch(scriptURL);
      let data = await res.json();
      document.getElementById("output").innerText = JSON.stringify(data);
    }
    document.getElementById("myForm").addEventListener("submit", function(e) {
      e.preventDefault();

      let data = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        message: document.getElementById("message").value
      };

      fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify(data)
      })
      .then(res => res.json())
      .then(response => {
        alert("Data saved: " + response.result)
        document.getElementById("myForm").reset(); // Reset form after save
      })
      .catch(err => alert("Error: " + err));
    });

    
  </script>
</body>
</html>
